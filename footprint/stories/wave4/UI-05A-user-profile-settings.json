{
  "story_id": "UI-05A",
  "wave_number": 4,
  "title": "User Profile Settings Page",
  "domain": "frontend",
  "agent": "fe-dev",
  "priority": "high",
  "story_points": 3,
  "description": "Create user profile settings page with form to view and edit profile information including name, phone, avatar, and language preference",
  "status": "pending",

  "objective": {
    "as_a": "Footprint user",
    "i_want": "to view and edit my profile settings",
    "so_that": "I can keep my personal information up to date"
  },

  "acceptance_criteria": [
    {
      "id": "AC-001",
      "description": "Page displays current user profile data on load",
      "test_approach": "Mock useProfile hook, verify name, email, phone, language displayed"
    },
    {
      "id": "AC-002",
      "description": "Page shows loading spinner while fetching profile",
      "test_approach": "Set isLoading=true in mock, verify spinner visible"
    },
    {
      "id": "AC-003",
      "description": "Page shows error state with retry button on fetch failure",
      "test_approach": "Set isError=true in mock, verify error message and retry button"
    },
    {
      "id": "AC-004",
      "description": "Name field is editable with validation (min 2 chars)",
      "test_approach": "Enter single char, verify validation error displayed"
    },
    {
      "id": "AC-005",
      "description": "Phone field is editable with Israeli format validation",
      "test_approach": "Enter invalid phone, verify validation error displayed"
    },
    {
      "id": "AC-006",
      "description": "Email field is displayed but not editable (read-only)",
      "test_approach": "Verify email input has disabled attribute"
    },
    {
      "id": "AC-007",
      "description": "Language preference selector with Hebrew/English options",
      "test_approach": "Verify select has 'he' and 'en' options"
    },
    {
      "id": "AC-008",
      "description": "Avatar displays current image with upload button",
      "test_approach": "Verify avatar image and upload button rendered"
    },
    {
      "id": "AC-009",
      "description": "Save button submits form and shows loading state",
      "test_approach": "Click save, verify loading spinner on button"
    },
    {
      "id": "AC-010",
      "description": "Success toast shown after successful update",
      "test_approach": "Mock successful mutation, verify success toast displayed"
    },
    {
      "id": "AC-011",
      "description": "Error toast shown on update failure",
      "test_approach": "Mock failed mutation, verify error toast displayed"
    },
    {
      "id": "AC-012",
      "description": "Page is fully RTL with Hebrew labels",
      "test_approach": "Verify dir='rtl' and Hebrew text for all labels"
    },
    {
      "id": "AC-013",
      "description": "Page is mobile-first responsive (max-width 600px)",
      "test_approach": "Verify max-w-[600px] class on container"
    },
    {
      "id": "AC-014",
      "description": "Back navigation to account page",
      "test_approach": "Click back button, verify navigation to /account"
    }
  ],

  "files": {
    "create": [
      "app/(app)/account/profile/page.tsx",
      "components/account/ProfileForm.tsx",
      "components/account/ProfileForm.test.tsx",
      "components/account/AvatarUpload.tsx",
      "components/account/AvatarUpload.test.tsx",
      "hooks/useProfile.ts",
      "hooks/useProfile.test.ts",
      "hooks/useUpdateProfile.ts",
      "hooks/useUpdateProfile.test.ts"
    ],
    "modify": [],
    "forbidden": [
      "app/api/profile/route.ts",
      "lib/auth/*"
    ]
  },

  "technical_requirements": {
    "reuse_components": [
      "components/ui/Input.tsx",
      "components/ui/Button.tsx",
      "components/ui/Card.tsx",
      "components/ui/Select.tsx",
      "components/account/OrderHistoryList.tsx - layout pattern"
    ],
    "hooks": [
      "useProfile - fetch current user profile",
      "useUpdateProfile - mutation to update profile"
    ],
    "validation": "lib/validation/profile.ts - Zod schema"
  },

  "tdd": {
    "test_framework": "vitest",
    "test_files": [
      "components/account/ProfileForm.test.tsx",
      "components/account/AvatarUpload.test.tsx",
      "hooks/useProfile.test.ts",
      "hooks/useUpdateProfile.test.ts"
    ],
    "coverage_target": 90,
    "test_categories": [
      {
        "name": "Loading State",
        "count": 2,
        "examples": [
          "should show loading spinner while fetching",
          "should hide loading spinner after fetch"
        ]
      },
      {
        "name": "Error State",
        "count": 2,
        "examples": [
          "should show error message on fetch failure",
          "should call refetch when retry clicked"
        ]
      },
      {
        "name": "Profile Display",
        "count": 4,
        "examples": [
          "should display user name",
          "should display user email (read-only)",
          "should display user phone",
          "should display language preference"
        ]
      },
      {
        "name": "Form Validation",
        "count": 4,
        "examples": [
          "should validate name minimum length",
          "should validate phone format",
          "should show validation errors",
          "should clear errors on valid input"
        ]
      },
      {
        "name": "Form Submission",
        "count": 4,
        "examples": [
          "should call updateProfile mutation on save",
          "should show loading state on button",
          "should show success toast on success",
          "should show error toast on failure"
        ]
      },
      {
        "name": "Avatar Upload",
        "count": 3,
        "examples": [
          "should display current avatar",
          "should trigger file picker on click",
          "should show upload progress"
        ]
      },
      {
        "name": "RTL & Accessibility",
        "count": 3,
        "examples": [
          "should have dir=rtl on container",
          "should use Hebrew labels",
          "should have proper ARIA attributes"
        ]
      },
      {
        "name": "Navigation",
        "count": 2,
        "examples": [
          "should have back button",
          "should navigate to /account on back click"
        ]
      }
    ],
    "mocking_strategy": {
      "hooks": "vi.mock('@/hooks/useProfile')",
      "navigation": "vi.mock('next/navigation')"
    }
  },

  "safety": {
    "stop_conditions": [
      "Any modification to authentication flow",
      "Changes to API endpoints"
    ],
    "escalation_triggers": [
      "Accessibility issues",
      "Form validation bypasses"
    ],
    "rollback_plan": "Delete new component and page files"
  },

  "dependencies": {
    "required_before": ["BE-04"],
    "blocks": []
  },

  "estimated_tests": 24
}
