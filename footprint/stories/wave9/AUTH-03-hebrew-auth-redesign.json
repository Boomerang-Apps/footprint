{
  "$schema": "../../planning/schemas/story-schema-v4.3.json",
  "schema_version": "4.3",
  "story_id": "AUTH-03",
  "type": "feature",
  "wave_number": 9,
  "title": "Hebrew Auth Pages Redesign - Modern Login & Signup",
  "domain": "frontend",
  "agent": "fe-dev",
  "priority": "P1",
  "story_points": 5,
  "description": "Redesign login and signup pages to be fully Hebrew RTL with a sleek, modern visual design. Current pages are entirely in English with a dated look. The redesign converts all UI text to Hebrew, adds brand identity (gradient accents, brand-purple theming), modernizes the visual style with refined inputs/cards/shadows, and ensures a polished mobile-first experience.",
  "status": "complete",
  "objective": {
    "as_a": "Hebrew-speaking customer visiting Footprint",
    "i_want": "login and signup pages in Hebrew with a modern, professional design",
    "so_that": "I feel confident using the site and can navigate auth flows in my native language"
  },
  "acceptance_criteria": [
    {
      "id": "AC-01",
      "description": "Login page heading and subtitle in Hebrew",
      "ears_format": "WHEN user navigates to /login THEN heading displays 'ברוכים השבים' and subtitle displays 'התחברו לחשבון שלכם כדי להמשיך'",
      "test_approach": "Render login page, verify Hebrew heading and subtitle text",
      "status": "passed"
    },
    {
      "id": "AC-02",
      "description": "Login form labels and placeholders in Hebrew",
      "ears_format": "WHEN login page renders THEN email label shows 'אימייל', password label shows 'סיסמה', placeholders in Hebrew, button shows 'התחברות'",
      "test_approach": "Verify all form labels, placeholders, and button text are in Hebrew",
      "status": "passed"
    },
    {
      "id": "AC-03",
      "description": "Login links in Hebrew",
      "ears_format": "WHEN login page renders THEN forgot password shows 'שכחת סיסמה?' and signup link shows 'אין לך חשבון? הרשמה'",
      "test_approach": "Verify link text is Hebrew, href correct",
      "status": "passed"
    },
    {
      "id": "AC-04",
      "description": "Login validation messages in Hebrew",
      "ears_format": "WHEN user submits empty login form THEN error shows 'אימייל הוא שדה חובה' and 'סיסמה היא שדה חובה'",
      "test_approach": "Submit empty form, verify Hebrew error messages",
      "status": "passed"
    },
    {
      "id": "AC-05",
      "description": "Login loading state in Hebrew",
      "ears_format": "WHEN login is in progress THEN button shows 'מתחבר...' with spinner",
      "test_approach": "Trigger loading state, verify Hebrew loading text",
      "status": "passed"
    },
    {
      "id": "AC-06",
      "description": "Signup page heading and subtitle in Hebrew",
      "ears_format": "WHEN user navigates to /register THEN heading displays 'יצירת חשבון' and subtitle displays 'הרשמו כדי להתחיל ליצור הדפסים'",
      "test_approach": "Render register page, verify Hebrew heading and subtitle",
      "status": "passed"
    },
    {
      "id": "AC-07",
      "description": "Signup form labels and placeholders in Hebrew",
      "ears_format": "WHEN register page renders THEN labels show 'שם מלא', 'אימייל', 'סיסמה', 'אימות סיסמה' with Hebrew placeholders",
      "test_approach": "Verify all register form labels and placeholders are Hebrew",
      "status": "passed"
    },
    {
      "id": "AC-08",
      "description": "Signup validation messages in Hebrew",
      "ears_format": "WHEN user submits invalid register form THEN errors show Hebrew messages: 'נא למלא את כל השדות', 'הסיסמאות אינן תואמות', 'הסיסמה חייבת להכיל לפחות 6 תווים'",
      "test_approach": "Trigger each validation path, verify Hebrew error messages",
      "status": "passed"
    },
    {
      "id": "AC-09",
      "description": "Signup links and button in Hebrew",
      "ears_format": "WHEN register page renders THEN button shows 'יצירת חשבון', loading shows 'יוצר חשבון...', link shows 'כבר יש לך חשבון? התחברות'",
      "test_approach": "Verify button text, loading state, and sign-in link are Hebrew",
      "status": "passed"
    },
    {
      "id": "AC-10",
      "description": "Social login buttons in Hebrew",
      "ears_format": "WHEN social login buttons render THEN labels show 'המשך עם Google', 'המשך עם Facebook', 'המשך עם Apple' and divider shows 'או'",
      "test_approach": "Render SocialLoginButtons with Hebrew labels, verify text",
      "status": "passed"
    },
    {
      "id": "AC-11",
      "description": "Modern card design with brand identity",
      "ears_format": "WHEN auth pages render THEN card uses rounded-2xl, soft shadow, brand-purple gradient accent at top",
      "test_approach": "Visual inspection - verify card has rounded-2xl, shadow-soft-lg, gradient accent",
      "status": "passed"
    },
    {
      "id": "AC-12",
      "description": "Modern input styling",
      "ears_format": "WHEN auth form inputs render THEN inputs use rounded-xl borders, h-12 height, smooth focus transitions with brand-purple ring",
      "test_approach": "Verify input className includes rounded-xl, h-12, transition styling",
      "status": "passed"
    },
    {
      "id": "AC-13",
      "description": "Social buttons with provider brand colors",
      "ears_format": "WHEN social buttons render THEN Google button has white bg with subtle border, Facebook uses #1877F2 bg, Apple uses black bg",
      "test_approach": "Verify social button styling per provider brand guidelines",
      "status": "passed"
    },
    {
      "id": "AC-14",
      "description": "Mobile-first responsive layout",
      "ears_format": "WHEN auth page viewed on mobile THEN card is full-width with px-4 padding, no max-width constraint on small screens",
      "test_approach": "Render at mobile viewport, verify responsive layout",
      "status": "passed"
    },
    {
      "id": "AC-15",
      "description": "Auth layout with subtle gradient background",
      "ears_format": "WHEN auth layout renders THEN background shows subtle gradient from white to brand-purple/5",
      "test_approach": "Verify auth layout has gradient background styling",
      "status": "passed"
    },
    {
      "id": "AC-16",
      "description": "RTL direction explicitly set on auth forms",
      "ears_format": "WHEN auth forms render THEN dir='rtl' is set on the form container",
      "test_approach": "Verify dir attribute on form element",
      "status": "passed"
    },
    {
      "id": "AC-17",
      "description": "Existing auth functionality preserved",
      "ears_format": "WHEN all visual changes applied THEN email/password login, Google/Facebook/Apple OAuth, form validation, and navigation all work identically",
      "test_approach": "Run full existing test suite - all tests pass",
      "status": "passed"
    },
    {
      "id": "AC-18",
      "description": "Password visibility toggle accessible in RTL",
      "ears_format": "WHEN password field renders in RTL THEN eye toggle icon positioned at left side with proper RTL padding",
      "test_approach": "Verify toggle button position in RTL layout",
      "status": "passed"
    }
  ],
  "context": {
    "read_files": [
      "components/auth/PostPurchaseSignup.tsx",
      "components/auth/LoginForm.tsx",
      "components/auth/SocialLoginButtons.tsx",
      "app/(auth)/login/page.tsx",
      "app/(auth)/register/page.tsx",
      "tailwind.config.ts"
    ],
    "similar_implementations": [
      "components/auth/PostPurchaseSignup.tsx"
    ]
  },
  "execution": {
    "model_tier": "opus",
    "checkpoint_frequency": "per_gate",
    "parallel_with": ["FAV-01"]
  },
  "files": {
    "create": [],
    "modify": [
      "app/(auth)/layout.tsx",
      "app/(auth)/login/page.tsx",
      "app/(auth)/register/page.tsx",
      "components/auth/LoginForm.tsx",
      "components/auth/SocialLoginButtons.tsx",
      "components/auth/LoginForm.test.tsx",
      "components/auth/SocialLoginButtons.test.tsx"
    ],
    "forbidden": [
      "lib/supabase/*",
      "app/api/auth/*",
      "app/auth/callback/*"
    ]
  },
  "design_source": {
    "type": "none",
    "verified": true,
    "verified_at": "2026-02-14T12:00:00Z"
  },
  "technical_requirements": {
    "reuse_components": [
      "components/ui/Button.tsx",
      "components/ui/Input.tsx",
      "components/ui/Card.tsx"
    ],
    "reuse_patterns": {
      "PostPurchaseSignup": "Follow Hebrew pattern from components/auth/PostPurchaseSignup.tsx",
      "tailwind_theme": "Use existing brand-purple, shadow-soft-lg, rounded-2xl from tailwind.config.ts"
    },
    "state_management": "No state changes - visual/text only refactor"
  },
  "tdd": {
    "test_framework": "vitest",
    "test_files": [
      "components/auth/LoginForm.test.tsx",
      "components/auth/SocialLoginButtons.test.tsx"
    ],
    "coverage_target": 90,
    "test_categories": [
      {
        "name": "Hebrew Login Text",
        "count": 6,
        "examples": [
          "renders Hebrew heading 'ברוכים השבים'",
          "renders Hebrew email label 'אימייל'",
          "renders Hebrew submit button 'התחברות'",
          "shows Hebrew error 'אימייל הוא שדה חובה'",
          "shows Hebrew loading text 'מתחבר...'"
        ]
      },
      {
        "name": "Hebrew Signup Text",
        "count": 5,
        "examples": [
          "renders Hebrew heading 'יצירת חשבון'",
          "renders Hebrew name label 'שם מלא'",
          "shows Hebrew validation 'הסיסמאות אינן תואמות'"
        ]
      },
      {
        "name": "Hebrew Social Buttons",
        "count": 3,
        "examples": [
          "renders 'המשך עם Google' label",
          "renders Hebrew divider 'או'"
        ]
      },
      {
        "name": "RTL Layout",
        "count": 2,
        "examples": [
          "login form has dir='rtl'",
          "social buttons container has dir='rtl'"
        ]
      },
      {
        "name": "Visual Design",
        "count": 3,
        "examples": [
          "card has rounded-2xl and shadow classes",
          "inputs use rounded-xl and h-12 styling"
        ]
      },
      {
        "name": "Existing Functionality Preserved",
        "count": 6,
        "examples": [
          "calls onSubmit with email and password on valid submission",
          "toggles password visibility",
          "Google OAuth handler called on click"
        ]
      }
    ],
    "mocking_strategy": {
      "supabase": "vi.mock('@/lib/supabase/client')",
      "next_router": "vi.mock('next/navigation')",
      "next_link": "Mock next/link as anchor element"
    }
  },
  "safety": {
    "stop_conditions": [
      "Any modification to Supabase auth logic or OAuth callback handling",
      "Changes to API route handlers",
      "Removal of accessibility attributes (aria-*, role, etc.)"
    ],
    "escalation_triggers": [
      "OAuth flow stops working after changes",
      "More than 5 test failures unrelated to text changes"
    ],
    "rollback_plan": "Git revert - all changes are visual/text only, zero backend impact"
  },
  "hazard_analysis": {
    "identified_hazards": [
      {
        "id": "HAZ-001",
        "description": "Test regressions from changed text - existing tests match English strings",
        "severity": "major",
        "likelihood": "frequent",
        "mitigation": "Update all test assertions to match new Hebrew text. Run full test suite before and after."
      },
      {
        "id": "HAZ-002",
        "description": "OAuth callback breaks if form structure changes",
        "severity": "critical",
        "likelihood": "remote",
        "mitigation": "OAuth handlers are in page-level components, not in LoginForm. No changes to Supabase auth calls."
      },
      {
        "id": "HAZ-003",
        "description": "RTL layout breaks password visibility toggle positioning",
        "severity": "minor",
        "likelihood": "occasional",
        "mitigation": "Use logical properties (start/end) instead of left/right for toggle positioning"
      }
    ],
    "risk_level": "low"
  },
  "dependencies": {
    "required_before": ["AUTH-01"],
    "blocks": []
  },
  "traceability": {
    "requirements": ["PRD-AUTH", "PRD-I18N"],
    "epic": "USER-AUTH",
    "related_stories": ["AUTH-01", "AUTH-02"]
  },
  "output": {
    "files_created": [],
    "files_modified": [
      "app/(auth)/layout.tsx",
      "app/(auth)/login/page.tsx",
      "app/(auth)/register/page.tsx",
      "components/auth/LoginForm.tsx",
      "components/auth/SocialLoginButtons.tsx",
      "components/auth/LoginForm.test.tsx",
      "components/auth/SocialLoginButtons.test.tsx",
      "components/checkout/CheckoutAuthFlow.tsx"
    ],
    "tests_passing": true,
    "coverage_achieved": 90,
    "pr_description": "feat(AUTH-03): Hebrew auth redesign — modern login & signup pages"
  },
  "validation": {
    "lint_command": "pnpm lint",
    "test_command": "pnpm test:run",
    "build_command": "pnpm build",
    "type_check_command": "pnpm type-check"
  },
  "gates_completed": ["gate-0", "gate-1", "gate-2", "gate-3", "gate-7"],
  "estimated_tests": 25,
  "metadata": {
    "created_at": "2026-02-14T12:00:00Z",
    "created_by": "claude-opus-4-6",
    "updated_at": "2026-02-14T15:00:00Z"
  },
  "notes": "Pure visual + i18n refactor. No auth logic changes. PR #27 merged to main (commit 1b2b658). 20 LoginForm tests + 27 SocialLoginButtons tests rewritten for Hebrew assertions. 3391 tests passing at merge."
}
